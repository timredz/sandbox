<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">

<meta http-equiv="content-language" content="ru" />
<title>Logica</title>
<!-- main css -->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<style>
#area{
	margin: 10px auto;
	width:220px;
	max-height:350px;
	border:2px solid #d3d3d3;
	border-radius: 15px;
}
.w3-modal-content {
    width: 230px;
}
.w3-modal{
	padding:20px;
	padding-top:330px;
	padding-left:0px;
	background-color: rgba(0,0,0,0);
}
#select_colors{
	display:none;
}
.cust_btn{
	width:100%;
}
.header{
	width:130px;
	margin: 0 auto;
}
</style>
</head>

<body>
	<div id="container">
	<h1 class="header">LOGICA</h1>
		<div id="area">
			<svg width="215" height="350">
			  <g id="step6">
				  <rect x="10" y="10" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r60" cx="18" cy="18" r="5" style="fill:grey"/>
				  <circle id="r61" cx="32" cy="18" r="5" style="fill:grey"/>
				  <circle id="r62" cx="18" cy="32" r="5" style="fill:grey"/>
				  <circle id="r63" cx="32" cy="32" r="5" style="fill:grey"/>
				  
				  <circle id="61" cx="70" cy="26" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="62" cx="110" cy="26" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="63" cx="150" cy="26" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="64" cx="190" cy="26" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  <g id="step5">
				  <rect x="10" y="60" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r50" cx="18" cy="68" r="5" style="fill:grey"/>
				  <circle id="r51" cx="32" cy="68" r="5" style="fill:grey"/>
				  <circle id="r52" cx="18" cy="82" r="5" style="fill:grey"/>
				  <circle id="r53" cx="32" cy="82" r="5" style="fill:grey"/>
				  
				  <circle id="51" cx="70" cy="76" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="52" cx="110" cy="76" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="53" cx="150" cy="76" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="54" cx="190" cy="76" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  <g id="step4">
				  <rect x="10" y="110" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r40" cx="18" cy="118" r="5" style="fill:grey"/>
				  <circle id="r41" cx="32" cy="118" r="5" style="fill:grey"/>
				  <circle id="r42" cx="18" cy="132" r="5" style="fill:grey"/>
				  <circle id="r43" cx="32" cy="132" r="5" style="fill:grey"/>
				  
				  <circle id="41" cx="70" cy="126" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="42" cx="110" cy="126" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="43" cx="150" cy="126" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="44" cx="190" cy="126" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  <g id="step3">
				  <rect x="10" y="160" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r30" cx="18" cy="168" r="5" style="fill:grey"/>
				  <circle id="r31" cx="32" cy="168" r="5" style="fill:grey"/>
				  <circle id="r32" cx="18" cy="182" r="5" style="fill:grey"/>
				  <circle id="r33" cx="32" cy="182" r="5" style="fill:grey"/>
				  
				  <circle id="31" cx="70" cy="176" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="32" cx="110" cy="176" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="33" cx="150" cy="176" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="34" cx="190" cy="176" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  <g id="step2">
				  <rect x="10" y="210" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r20" cx="18" cy="218" r="5" style="fill:grey"/>
				  <circle id="r21" cx="32" cy="218" r="5" style="fill:grey"/>
				  <circle id="r22" cx="18" cy="232" r="5" style="fill:grey"/>
				  <circle id="r23" cx="32" cy="232" r="5" style="fill:grey"/>
				  
				  <circle id="21" cx="70" cy="226" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="22" cx="110" cy="226" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="23" cx="150" cy="226" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="24" cx="190" cy="226" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  <g id="step1">
				  <rect x="10" y="260" width="30" height="30" rx="4" ry="4" style="fill:pink"/>
				  
				  <circle id="r10" cx="18" cy="268" r="5" style="fill:grey"/>
				  <circle id="r11" cx="32" cy="268" r="5" style="fill:grey"/>
				  <circle id="r12" cx="18" cy="282" r="5" style="fill:grey"/>
				  <circle id="r13" cx="32" cy="282" r="5" style="fill:grey"/>
				  
				  <circle id="11" cx="70" cy="276" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="12" cx="110" cy="276" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="13" cx="150" cy="276" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
				  <circle id="14" cx="190" cy="276" r="15" style="fill:grey" onclick="remember_cicrcle()"/>
			  </g>
			  
			  <g id="select_colors">
				<circle class = "plt" cx="30" cy="320" r="12" style="fill:#F44336" onclick="get_color()"/>
				<circle class = "plt" cx="60" cy="320" r="12" style="fill:#E91E63" onclick="get_color()"/>
				<circle class = "plt" cx="90" cy="320" r="12" style="fill:#3F51B5" onclick="get_color()"/>
				<circle class = "plt" cx="120" cy="320" r="12" style="fill:#2196F3" onclick="get_color()"/>
				<circle class = "plt" cx="150" cy="320" r="12" style="fill:#4CAF50" onclick="get_color()"/>
				<circle class = "plt" cx="180" cy="320" r="12" style="fill:#FFC107" onclick="get_color()"/>
			  </g>
			  
			</svg>
			<button class="cust_btn w3-button w3-blue w3-round-large" onclick="init_income()">CHECK</button>
		</div>
		
	</div>
</body>
<script>

dict = {'rgb(244, 67, 54)': 0, 'rgb(233, 30, 99)' : 1, 'rgb(63, 81, 181)' : 2, 'rgb(33, 150, 243)' : 3, 'rgb(76, 175, 80)' : 4, 'rgb(255, 193, 7)' : 5};
rdict = {0: 'rgb(244, 67, 54)', 1: 'rgb(233, 30, 99)', 2: 'rgb(63, 81, 181)', 3: 'rgb(33, 150, 243)', 4: 'rgb(76, 175, 80)', 5: 'rgb(255, 193, 7)'};
var gid = 0;
var remembered = '';
var STEP = 1;

function get_color(){
	$( "g#select_colors" ).click(function( event ) {
	if($(event.target).attr("class") == "plt"){
	  remembered = ($(event.target).css("fill"));
	  set_color();
	  document.getElementById('select_colors').style.display='none';
	}
	});
	
}
function remember_cicrcle(){
	$( "g#step" + STEP ).click(function( event ) {
	  gid = event.target.id;
	  $( "circle" ).removeAttr("stroke");
	  $(event.target).attr("stroke-width", 2);
	  $(event.target).attr("stroke", "#9999ff");
	});
	document.getElementById('select_colors').style.display='block'
}
function set_color(){
	$('#' + gid).css('fill',remembered);
}
game = [];
generate_game();
function generate_game(){
	for (var i = 0;i < 4; i++){
		game[i] = Math.trunc(Math.random() * (6));
	}
}

var income = [];
function init_income(){
	var circ_div = "circle#" + STEP;
	income[0] = dict[$(circ_div + '1').css('fill')];
	income[1] = dict[$(circ_div + '2').css('fill')];
	income[2] = dict[$(circ_div + '3').css('fill')];
	income[3] = dict[$(circ_div + '4').css('fill')];
	if(hard_compare() == 4){
		imageUrl = 'win2.jpg';
		$('body').css('background-image', 'url(' + imageUrl + ')');
	}
	var kk = 0;
	for(var i=0;i<4;i++){
		if(income[i]>=0){
			kk += 1;
		}
	}
	if(kk == 4){
		display_result();
		STEP += 1;
		$( "circle" ).removeAttr("stroke");
	}
	if(STEP == 7){
		imageUrl = 'lose.jpg';
		$('body').css('background-image', 'url(' + imageUrl + ')');
		var out = '<rect x="50" y="300" width="160" height="40" style="fill:white;stroke:red;stroke-width:2"/>' +
					'<circle cx="70" cy="320" r="15" style="fill:' + rdict[game[0]] + '"/>' +
					'<circle cx="110" cy="320" r="15" style="fill:' + rdict[game[1]] + '"/>' + 
					'<circle cx="150" cy="320" r="15" style="fill:' + rdict[game[2]] + '"/>' +
					'<circle cx="190" cy="320" r="15" style="fill:' + rdict[game[3]] + '"/>';
		$("g#select_colors").html(out);
		document.getElementById('select_colors').style.display='block'
	}
}

function hard_compare(){
	var k = 0;
	for(var i=0;i<4;i++){
		if(game[i] == income[i]){
			k++;
		}
	}
	return k;
}
var temp_game = [];
function soft_compare(){
	var k = 0;
	temp_game = game.slice();
	for(var i=0;i<4;i++){
		if(temp_game.includes(income[i])){
			k++;
			temp_game[temp_game.indexOf(income[i])] = -1;
		}
	}
	return k;
}

function display_result(){
	var b = hard_compare();
	var w = soft_compare();
	for(var i=0;i<b;i++){
		$('circle#r' + STEP + i).css('fill', 'black');
	}
	
	for(var i=b;i<w;i++){
		$('circle#r' + STEP + i).css('fill', 'white');
	}
}

</script>
</html>